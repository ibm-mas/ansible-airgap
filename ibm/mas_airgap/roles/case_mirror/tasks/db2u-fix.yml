---
# Note: We can re-use the authentication file generated by the previous tasks
- name: "{{ case_name }} : Mirror norootsquash image (Db2u special case 1/2)"
  when: case_name == "ibm-db2uoperator"
  shell: "skopeo copy --dest-tls-verify=false --authfile='{{ ansible_env.HOME }}/.airgap/auth.json' --all docker://cp.icr.io/cp/cpd/norootsquash@sha256:5dbe9310d15cbe452f6099017defd411eeb6eebb2fecea5d99463227e2518574 docker://{{ registry_public_url }}/cp/cpd/norootsquash:3.0-amd64"

- name: "{{ case_name }} : Mirror extra db2u images to airgap registry (Db2u special case 2/2)"
  when: case_name == "ibm-db2uoperator"
  shell: "skopeo copy --dest-tls-verify=false --authfile='{{ ansible_env.HOME }}/.airgap/auth.json' --all docker://icr.io/db2u/{{ item.name }}@{{ item.digest }} docker://{{ registry_public_url }}/db2u/{{ item.name }}@{{ item.digest }}"
  with_items: "{{ db2u_extra_images }}"
